Per prima cosa ho fatto una scansione con nmap, ho trovato due porte aperte, una ssh 22, e una 5000 http con gunicorn, cercato vulnerabilità per gunicorn, non ho trovato nulla di interessante quindi ho visitato il sito sulla porta 5000, è un python code editor, per prima cosa provo a fare un injection ma mi da in output Use of restricted keywords is not allowed.
uso print(global()) per vedere tutte le dipendenze, noto che ci sono delle dipendenze per un database, quindi provo a usare il comando print(dir(db)), effettivamente db è un istanza quindi posso provare ad ottenere i dati, for user in User.query.all():
    print(user.__dict__)
con questo script python ottengo tutti gli utenti del database, vedo che c'è un utente martin, con una password, hashata, uso hashcat e ottengo la password, ora con il comando ssh entro nell'utente martin, all'interno non trovo la user flag, però noto che c'è un altro utente app-program in cui non posso entrare, per prima cosa provo a fare sudo -l, vedo che c'è un programma bash che esegue backup seguendo le indicazioni di un file json, vado nella cartella dove effettua i backup e c'è un archivio tar, lo scarico tramite scp e unzippandolo trovo la user flag all'interno, ora devo ottenere la root flag, per fare ciò modifico il file json che il programma bash segue per fare in modo di effettuare in backup della root, per fare ciò il problema è stato che il backup lo fa solo delle cartelle var e home, per evitare questo problema ho fatto il backup di questo path var/....//root, (../ in piu sono perche se metti ../ li cancella, cosi aggiro il problema in quanto rimangono ../) una volta eseguito il programma bash che segue il json ottengo un archivio tar, come prima uso scp e unzippandolo ottengo la root flag.
mi riscrivi questo report in md in modo piu dettagliato per favore, la ctf che ho fatto si chiama code